<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Schedule Builder - Data Fix</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .status {
            font-size: 1.2rem;
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
        }
        button {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 1rem;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
        }
        .success {
            background: rgba(16, 185, 129, 0.3);
            border: 1px solid rgba(16, 185, 129, 0.5);
        }
        .error {
            background: rgba(239, 68, 68, 0.3);
            border: 1px solid rgba(239, 68, 68, 0.5);
        }
        .info {
            background: rgba(59, 130, 246, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Visual Schedule Builder Data Fix</h1>
        <p>This tool will populate your Visual Schedule Builder with test data to resolve the empty students issue.</p>
        
        <div id="status" class="status info">
            Ready to fix your data structure
        </div>
        
        <button id="fixButton" onclick="fixData()">üöÄ Fix Data Now</button>
        <button id="openAppButton" onclick="openApp()" style="display: none;">üì± Open Visual Schedule Builder</button>
        
        <div style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.8;">
            <p><strong>What this will do:</strong></p>
            <ul style="text-align: left; display: inline-block;">
                <li>Create 3 test students with complete profiles</li>
                <li>Add 6 IEP goals with realistic data</li>
                <li>Add 6 data points for progress tracking</li>
                <li>Set up proper unified data structure</li>
                <li>Create migration logs for system compatibility</li>
            </ul>
        </div>
    </div>

    <script>
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function fixData() {
            const button = document.getElementById('fixButton');
            button.disabled = true;
            button.textContent = 'üîÑ Fixing Data...';
            
            updateStatus('Creating unified data structure...', 'info');
            
            try {
                // Execute the data fix script
                eval(document.getElementById('dataFixScript').textContent);
            } catch (error) {
                console.error('Error fixing data:', error);
                updateStatus('‚ùå Error: ' + error.message, 'error');
                button.disabled = false;
                button.textContent = 'üöÄ Fix Data Now';
            }
        }

        function openApp() {
            window.open('http://localhost:5173', '_blank');
        }

        // Embed the data fix script
        const script = document.createElement('script');
        script.id = 'dataFixScript';
        script.type = 'text/plain';
        script.textContent = `
// Create proper unified data structure for Visual Schedule Builder
console.log('üöÄ Creating unified data structure...');

// Create the unified data in the exact format expected by DataMigrationManager
const unifiedData = {
  students: {
    'student1': {
      id: 'student1',
      name: 'Emma Wilson',
      grade: 'Kindergarten',
      photo: undefined,
      photoFileName: undefined,
      isActive: true,
      workingStyle: 'collaborative',
      accommodations: ['Visual supports', 'Extra time'],
      goals: ['Will identify letters A-Z with 90% accuracy', 'Will read 25 sight words with 80% accuracy'],
      behaviorNotes: 'Responds well to positive reinforcement',
      medicalNotes: '',
      parentName: 'Sarah Wilson',
      parentEmail: 'sarah.wilson@email.com',
      parentPhone: '(555) 123-4567',
      emergencyContact: 'Sarah Wilson - (555) 123-4567',
      resourceInfo: {
        attendsResource: false,
        resourceType: '',
        resourceTeacher: '',
        timeframe: ''
      },
      preferredPartners: [],
      avoidPartners: [],
      iepData: {
        hasIEP: true,
        goals: [
          {
            id: 'goal1_emma',
            studentId: 'student1',
            title: 'Letter Recognition',
            description: 'Will identify letters A-Z with 90% accuracy',
            shortTermObjective: 'Identify 5 new letters each week',
            domain: 'academic',
            measurementType: 'percentage',
            criteria: '90% accuracy over 3 consecutive sessions',
            target: 90,
            currentProgress: 75,
            priority: 'high',
            dateCreated: '2025-01-15',
            isActive: true,
            linkedActivityIds: []
          },
          {
            id: 'goal2_emma',
            studentId: 'student1',
            title: 'Sight Word Reading',
            description: 'Will read 25 sight words with 80% accuracy',
            shortTermObjective: 'Read 5 new sight words each week',
            domain: 'academic',
            measurementType: 'percentage',
            criteria: '80% accuracy over 3 consecutive sessions',
            target: 80,
            currentProgress: 60,
            priority: 'high',
            dateCreated: '2025-01-15',
            isActive: true,
            linkedActivityIds: []
          }
        ],
        dataPoints: [
          {
            id: 'dp1_emma',
            goalId: 'goal1_emma',
            studentId: 'student1',
            date: '2025-01-20',
            time: '09:30',
            value: 18,
            totalOpportunities: 26,
            notes: 'Great progress with letters M, N, O',
            context: 'Morning literacy center',
            collector: 'Ms. Johnson',
            photos: [],
            voiceNotes: [],
            created_at: '2025-01-20T09:30:00.000Z'
          },
          {
            id: 'dp2_emma',
            goalId: 'goal2_emma',
            studentId: 'student1',
            date: '2025-01-20',
            time: '10:15',
            value: 12,
            totalOpportunities: 20,
            notes: 'Struggled with "where" and "when"',
            context: 'Reading group',
            collector: 'Ms. Johnson',
            photos: [],
            voiceNotes: [],
            created_at: '2025-01-20T10:15:00.000Z'
          }
        ],
        caseManager: 'Ms. Johnson',
        iepStartDate: '2025-01-15',
        iepEndDate: '2026-01-15',
        relatedServices: []
      },
      calendarData: {
        behaviorCommitments: [],
        independentChoices: [],
        dailyHighlights: []
      },
      progressData: {
        currentGoalProgress: {
          'goal1_emma': 75,
          'goal2_emma': 60
        },
        recentDataPoints: [
          {
            id: 'dp2_emma',
            goalId: 'goal2_emma',
            studentId: 'student1',
            date: '2025-01-20',
            time: '10:15',
            value: 12,
            totalOpportunities: 20,
            notes: 'Struggled with "where" and "when"',
            context: 'Reading group',
            collector: 'Ms. Johnson',
            photos: [],
            voiceNotes: [],
            created_at: '2025-01-20T10:15:00.000Z'
          },
          {
            id: 'dp1_emma',
            goalId: 'goal1_emma',
            studentId: 'student1',
            date: '2025-01-20',
            time: '09:30',
            value: 18,
            totalOpportunities: 26,
            notes: 'Great progress with letters M, N, O',
            context: 'Morning literacy center',
            collector: 'Ms. Johnson',
            photos: [],
            voiceNotes: [],
            created_at: '2025-01-20T09:30:00.000Z'
          }
        ],
        trends: {
          'goal1_emma': 'improving',
          'goal2_emma': 'maintaining'
        },
        lastAssessment: '2025-01-20'
      },
      createdAt: '2025-01-15T00:00:00.000Z',
      updatedAt: new Date().toISOString(),
      version: '2.0.0'
    },
    'student2': {
      id: 'student2',
      name: 'Marcus Johnson',
      grade: '1st Grade',
      photo: undefined,
      photoFileName: undefined,
      isActive: true,
      workingStyle: 'independent',
      accommodations: ['Movement breaks', 'Fidget tools'],
      goals: ['Will count to 100 by 1s, 5s, and 10s', 'Will sit for 15 minutes during instruction'],
      behaviorNotes: 'Works best with clear structure',
      medicalNotes: 'ADHD - takes medication at lunch',
      parentName: 'David Johnson',
      parentEmail: 'david.johnson@email.com',
      parentPhone: '(555) 234-5678',
      emergencyContact: 'David Johnson - (555) 234-5678',
      resourceInfo: {
        attendsResource: true,
        resourceType: 'Speech Therapy',
        resourceTeacher: 'Ms. Parker',
        timeframe: '10:00-
