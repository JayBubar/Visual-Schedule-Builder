<!DOCTYPE html>
<html>
<head>
    <title>Storage Check</title>
</head>
<body>
    <h1>Storage Inspection</h1>
    <div id="output"></div>
    
    <script>
        // Check localStorage for unified data
        const unifiedKey = 'visual-schedule-builder-unified-data';
        const unifiedData = localStorage.getItem(unifiedKey);
        
        let output = [];
        
        output.push('=== STORAGE INSPECTION ===');
        output.push('Unified Data Key: ' + unifiedKey);
        output.push('Unified Data Exists: ' + !!unifiedData);
        
        if (unifiedData) {
            try {
                const parsed = JSON.parse(unifiedData);
                output.push('Unified Data Structure:');
                output.push('- Students: ' + (Array.isArray(parsed.students) ? parsed.students.length : 'Not array/missing'));
                output.push('- Staff: ' + (Array.isArray(parsed.staff) ? parsed.staff.length : 'Not array/missing'));
                output.push('- Activities: ' + (Array.isArray(parsed.activities) ? parsed.activities.length : 'Not array/missing'));
                
                if (Array.isArray(parsed.students) && parsed.students.length > 0) {
                    output.push('First student: ' + parsed.students[0].name);
                    output.push('First student IEP goals: ' + (parsed.students[0].iepData?.goals?.length || 0));
                }
            } catch (e) {
                output.push('ERROR parsing unified data: ' + e.message);
            }
        } else {
            output.push('No unified data found');
        }
        
        // Check for legacy data
        const legacyKeys = ['students', 'iepGoals', 'iepDataPoints', 'staff_members'];
        legacyKeys.forEach(key => {
            const data = localStorage.getItem(key);
            output.push(key + ': ' + (data ? 'EXISTS' : 'MISSING'));
        });
        
        output.push('=== ALL STORAGE KEYS ===');
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && (key.includes('visual') || key.includes('student') || key.includes('staff') || key.includes('iep'))) {
                output.push('- ' + key);
            }
        }
        
        document.getElementById('output').innerHTML = '<pre>' + output.join('\n') + '</pre>';
    </script>
</body>
</html>
